{"version":3,"sources":["webpack://almost-dead-net/./node_modules/classnames/index.js","webpack://almost-dead-net/./src/components/link-with-previous-url.js","webpack://almost-dead-net/./src/helpers/string_helpers.js","webpack://almost-dead-net/./src/templates/song.js"],"names":["hasOwn","hasOwnProperty","classNames","classes","i","arguments","length","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","includes","key","call","join","module","exports","default","children","state","rest","Location","location","previousUrl","href","pluralize","number","word","sortSets","a","b","values","whichSet","SET_MAPPING","soundcheck","set1","set2","set3","encore1","encore2","SortableTable","columns","data","useTable","useSortBy","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","className","map","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","id","isSorted","isSortedDesc","render","row","getRowProps","classnames","original","stars","cells","cell","classNameTd","blank","value","getCellProps","url","fullData","showData","prior","song_id","after","to","highlight","endsWith","renderCell","Song","song","songsCsv","allSegues","allSeguesCsv","nodes","allSets","allSetsCsv","allShows","allShowsCsv","allSongPerformances","allSongperformancesCsv","teases","allTeasesCsv","onlyThisSongsPerformanceIds","performances","split","Error","onlyThisSongsPerformancesData","filter","songPerformance","performanceData","performanceIdStr","setData","find","set","setlist","show","setIdsInts","String","perfPositionInSet","indexOf","perfPriorId","songPerf","segue","propEq","type","song_name","entries","col_name","variation","date","title","nicknames","performancesData","useMemo","performancesColumns","accessor","Header","sortType","Date","getTime","disableSortBy","description","author","authorInfo","suite","Boolean","teaseData","performance_id","within"],"mappings":"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","file":"component---src-templates-song-js-7c39622ccef0f2596f01.js","sourcesContent":["/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n\n/* global define */\n(function () {\n  'use strict';\n\n  var hasOwn = {}.hasOwnProperty;\n  var nativeCodeString = '[native code]';\n\n  function classNames() {\n    var classes = [];\n\n    for (var i = 0; i < arguments.length; i++) {\n      var arg = arguments[i];\n      if (!arg) continue;\n      var argType = typeof arg;\n\n      if (argType === 'string' || argType === 'number') {\n        classes.push(arg);\n      } else if (Array.isArray(arg)) {\n        if (arg.length) {\n          var inner = classNames.apply(null, arg);\n\n          if (inner) {\n            classes.push(inner);\n          }\n        }\n      } else if (argType === 'object') {\n        if (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n          classes.push(arg.toString());\n          continue;\n        }\n\n        for (var key in arg) {\n          if (hasOwn.call(arg, key) && arg[key]) {\n            classes.push(key);\n          }\n        }\n      }\n    }\n\n    return classes.join(' ');\n  }\n\n  if (typeof module !== 'undefined' && module.exports) {\n    classNames.default = classNames;\n    module.exports = classNames;\n  } else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n    // register as 'classnames', consistent with npm package name\n    define('classnames', [], function () {\n      return classNames;\n    });\n  } else {\n    window.classNames = classNames;\n  }\n})();","import React from 'react'\nimport {Location} from '@reach/router'\nimport {Link} from 'gatsby'\n\nconst LinkWithPrevUrl = ({children, state, ...rest}) => (\n  <Location>\n    {({location}) =>\n      <Link {...rest} state={{previousUrl: location.href, ...state}}>\n        {children}\n      </Link>\n    }\n  </Location>\n)\n\nexport default LinkWithPrevUrl\n","/* Appends an \"s\" to the end of `word` if warranted by the value of `number` */\nexport function pluralize(number, word) {\n  return `${number} ${word}${number !== 1 ? 's' : ''}`\n}\n","import React, {useMemo} from 'react'\nimport {useSortBy, useTable} from 'react-table'\nimport {graphql} from 'gatsby'\nimport {find, propEq} from 'ramda'\nimport classnames from 'classnames'\n\nimport {pluralize} from '../helpers/string_helpers'\n\nimport Layout from '../components/layout'\nimport SEO from '../components/seo'\nimport Link from '../components/link-with-previous-url'\n\nimport './song.css'\n\nfunction authorInfo(author = null) {\n  switch (author) {\n    case null:\n    case '':\n      return false\n    case 'traditional':\n      return <p>(traditional)</p>\n    default:\n      return <p>by {author}</p>\n  }\n}\n\nfunction sortSets(a,b) {\n  if (a.values.whichSet === 'soundcheck')\n    return -1;\n  if (b.values.whichSet === 'soundcheck')\n    return 1;\n  if (a.values.whichSet === 'set 1')\n    return -1;\n  if (b.values.whichSet === 'set 1')\n    return 1;\n  if (a.values.whichSet === 'set 2')\n    return -1;\n  if (b.values.whichSet === 'set 2')\n    return 1;\n  if (a.values.whichSet === 'set 3')\n    return -1;\n  if (b.values.whichSet === 'set 3')\n    return 1;\n  if (a.values.whichSet === 'encore')\n    return -1;\n  if (b.values.whichSet === 'encore')\n    return 1;\n  if (a.values.whichSet === 'double encore')\n    return -1;\n  if (b.values.whichSet === 'double encore')\n    return 1;\n}\n\nconst SET_MAPPING = { // 'show table column name' to 'human readable set name'\n  soundcheck: 'soundcheck',\n  set1: 'set 1',\n  set2: 'set 2',\n  set3: 'set 3',\n  encore1: 'encore',\n  encore2: 'double encore',\n}\n\nexport const query = graphql`\n  query SongTemplate($songId: String!) {\n    songsCsv(id: {eq: $songId}) {\n      id\n      author\n      suite\n      title\n      nicknames\n      performances\n    }\n    allSeguesCsv { nodes {\n      id\n      from_perf_id\n      to_perf_id\n      type\n    }}\n    allSetsCsv { nodes {\n      id\n      setlist\n    } }\n    allShowsCsv { nodes {\n      id\n      date\n      encore1\n      encore2\n      set1\n      set2\n      set3\n      soundcheck\n    } }\n    allSongperformancesCsv { nodes {\n      id\n      song_id\n      song_name\n      stars\n    } }\n    allTeasesCsv(filter: {song_id: {eq: $songId}}) { nodes {\n      id\n      performance_id\n      within\n    } }\n  }\n`\n\nfunction renderCell({column, render, row}, previousUrl='') {\n  let url;\n  if (column.id === 'show')\n    url = `/show/${row.original.fullData.showData.id}`\n  else if (column.id === 'prior' && row.original.fullData.prior.song_id)\n    url = `/song/${row.original.fullData.prior.song_id}`\n  else if (column.id ===  'after' && row.original.fullData.after.song_id)\n    url = `/song/${row.original.fullData.after.song_id}`\n  if (url)\n    return <Link to={url} className={classnames({highlight: previousUrl.endsWith(url)})}>{render('Cell')}</Link>;\n  return render('Cell')\n}\n\nfunction SortableTable({columns, data, previousUrl=''}) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow\n  } = useTable({columns, data}, useSortBy)\n  return <table {...getTableProps()} className=\"sortable\">\n    <thead>\n      {headerGroups.map(headerGroup =>\n        <tr {...headerGroup.getHeaderGroupProps()}>\n          {headerGroup.headers.map(column =>\n            <th {...column.getHeaderProps(column.getSortByToggleProps())}\n                className={`sortable__cell-${column.id} ${column.isSorted ? column.isSortedDesc ? 'sorted-desc' : 'sorted-asc' : ''}`}>\n              {column.render('Header')}\n            </th>\n          )}\n        </tr>\n      )}\n    </thead>\n    <tbody {...getTableBodyProps()}>\n      {rows.map(row => {\n        prepareRow(row) // no return value; mutates `row`?\n        return <tr {...row.getRowProps()} className={classnames({[`stars-${row.original.stars}`]: row.original.stars})}>\n          {row.cells.map(cell => {\n            const classNameTd = classnames({\n              blank: cell.value === '[opener]' || cell.value === '[closer]',\n              [`sortable__cell-${cell.column.id}`]: true,\n            })\n            return <td {...cell.getCellProps()} className={classNameTd}>{renderCell(cell, previousUrl)}</td>\n          })}\n        </tr>\n      })}\n    </tbody>\n  </table>\n}\n\nexport default function Song({data: {\n  songsCsv: song,\n  allSeguesCsv: {nodes: allSegues},\n  allSetsCsv: {nodes: allSets},\n  allShowsCsv: {nodes: allShows},\n  allSongperformancesCsv: {nodes: allSongPerformances},\n  allTeasesCsv: {nodes: teases},\n}, location}) {\n  if (!song) {\n    return <p>Uh oh, no song data found...</p>\n  }\n  const onlyThisSongsPerformanceIds = song.performances.split(':')\n  if (!allSongPerformances.length) {\n    throw new Error('No data for allSongPerformances')\n  }\n  if (!allShows.length) {\n    throw new Error('No data for allShows')\n  }\n  if (!allSets.length) {\n    throw new Error('No data for allSets')\n  }\n  if (!allSegues.length) {\n    throw new Error('No data for allSegues')\n  }\n  const onlyThisSongsPerformancesData = allSongPerformances\n    .filter((songPerformance) => onlyThisSongsPerformanceIds.includes(songPerformance.id))\n    .map((performanceData) => {\n      const performanceIdStr = performanceData.id.toString()\n      const setData = find((set) =>\n        set.setlist && set.setlist.toString().split(':').includes(performanceIdStr)\n      )(allSets)\n      if (!setData)\n        throw new Error('No setData', {song, performanceData, allSets})\n      const showData = find((show) => [\n        show.soundcheck,\n        show.set1,\n        show.set2,\n        show.set3,\n        show.encore1,\n        show.encore2\n      ].includes(setData.id))(allShows)\n      if (!showData) {\n        throw new Error('No showData', {song, performanceData, setData, allShows})\n      }\n      const setIdsInts = String(setData.setlist).split(':')\n      const perfPositionInSet = setIdsInts.indexOf(performanceIdStr)\n      let prior;\n      if (perfPositionInSet > 0) {\n        const perfPriorId = setIdsInts[perfPositionInSet - 1]\n        prior = allSongPerformances.find(songPerf => songPerf.id === perfPriorId) // TODO refactor to use an object lookup\n        prior.segue = find(propEq('to_perf_id', performanceIdStr))(allSegues)?.type || ','\n      } else prior = {song_name: '[opener]'}\n      let after;\n      if (perfPositionInSet < setIdsInts.length - 1) {\n        after = allSongPerformances.find(songPerf => songPerf.id === setIdsInts[perfPositionInSet + 1])\n        after.segue = find(propEq('from_perf_id', performanceIdStr))(allSegues)?.type || ','\n      } else after = {song_name: '[closer]'}\n      const whichSet = Object.entries(SET_MAPPING)\n        .find(([col_name, _readable_name]) => showData[col_name] === setData.id)[1]\n      const variation = performanceData.variation\n        ? `(${performanceData.variation})`\n        : false\n      return {\n        show: showData.date,\n        prior: prior?.song_name,\n        'segue_prior': prior?.segue,\n        title: song.nicknames.split('; ')[0] || song.title,\n        stars: performanceData.stars,\n        'segue_after': after?.segue,\n        after: after?.song_name,\n        whichSet,\n        fullData: {performanceData, showData, variation, whichSet, prior, after}\n      }\n    })\n\n  const performancesData = useMemo(() => onlyThisSongsPerformancesData, [])\n  const performancesColumns = useMemo(\n    () => [\n      {accessor: 'show', Header: 'show', sortType: (a,b) => new Date(a.values.show).getTime() - new Date(b.values.show).getTime()}, // TODO memoize this fn\n      {accessor: 'whichSet', Header: 'where', sortType: sortSets},\n      {accessor: 'prior', Header: 'prior song'}, // TODO Filter out the/a\n      {accessor: 'segue_prior', Header: '>'},\n      {accessor: 'title', disableSortBy: true},\n      {accessor: 'segue_after', Header: '>'},\n      {accessor: 'after', Header: 'following song'}, // TODO Filter out the/a\n    ],\n    []\n  )\n\n  return <Layout className=\"songpage\">\n    <SEO\n      title={`\"${song.title}\" performed or teased by JRAD`}\n      description={`List of each time Joe Russo's Almost Dead has performed or teased the song \"${song.title}\" ${song.author && song.author !== 'traditional' ? `by ${song.author}` : ''}`}\n    />\n\n    <h1 className=\"songpage__name\">{song.title}</h1>\n    <div className=\"songpage__info\">\n      {authorInfo(song.author)}\n      {song.suite && <p>Part of the {song.suite} suite</p>}\n    </div>\n\n    {Boolean(performancesData.length) && // TODO verify that this count is accurate if a song is played twice in one show...\n      <div className=\"songpage__performances\">\n        <h2>Performed at {pluralize(performancesData.length, 'Show')}</h2>\n        <SortableTable\n          data={performancesData}\n          columns={performancesColumns}\n          previousUrl={location?.state?.previousUrl}\n        />\n      </div>\n    }\n\n    {Boolean(teases.length) &&\n      <div className=\"songpage__teases\">\n        <h2>Teases / Jams</h2>\n        <ul>\n          {teases.map(teaseData => {\n            const performanceData = find(propEq('id', teaseData.performance_id))(allSongPerformances)\n            if (!(performanceData?.id)) {\n              return false\n            }\n            const setData = find((set) => set.setlist.toString().split(':').includes(performanceData.id.toString()))(allSets)\n            const showData = find((show) => [show.soundcheck, show.set1, show.set2, show.set3, show.encore1, show.encore2].includes(setData.id))(allShows)\n            const url = `/show/${showData.id}`\n            return <li key={teaseData.id} className={classnames({highlight: location?.state?.previousUrl?.endsWith(url)})}>\n              <Link to={url}>{showData.date} within {teaseData.within} {performanceData.variation && `(${performanceData.variation})`}</Link>\n            </li>\n          })}\n        </ul>\n      </div>\n    }\n  </Layout>\n}\n"],"sourceRoot":""}