{"version":3,"sources":["webpack://almost-dead-net/./src/pages/songs.js"],"names":["removeCertainSongs","title","includes","sortBy","prop","Author","name","className","SongLink","data","author","core_gd","cover_gd","id","suite","full","performances","to","SortableTable","columns","link","useTable","useRowState","useSortBy","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","map","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","style","borderBottom","background","fontWeight","render","isSorted","isSortedDesc","row","getRowProps","cells","cell","getCellProps","original","SongsComponent","songs","allSongsCsv","nodes","teases","allTeasesCsv","groupedByPerformed","groupBy","songData","Boolean","filter","performedData","useMemo","String","split","length","performedColumns","Header","accessor","allSongIdsFromTeases","reduce","a","e","concat","song_id","groupedByTeased","teasedData","propEq","performance_id","teasedColumns","description","href","global","window","location","hash","query"],"mappings":"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","file":"component---src-pages-songs-js-35cd04bc3b557c214d72.js","sourcesContent":["import React, {useMemo} from 'react'\nimport {useRowState, useSortBy, useTable} from 'react-table'\nimport {Tooltip} from 'react-tippy'\nimport {graphql, Link, StaticQuery} from 'gatsby'\nimport {filter, groupBy, prop, propEq, sortBy} from 'ramda'\n\nimport Layout from '../components/layout'\nimport SEO from '../components/seo'\n\nimport './songs.css'\n\nconst removeCertainSongs = ({title}) => title && !['[unknown]', 'Drums', 'Jam', 'Space'].includes(title)\nconst sortByTitle = sortBy(prop('title')) // TODO ignore \"A\", \"The\", etc\n\nfunction Author({name}) {\n  if (!name || name === 'traditional') {\n    return false\n  }\n  return <span className=\"song__author\">\n    {name}\n  </span>\n}\nfunction PerformanceCount({perfIds, text = 'performed'}) {\n  if (!perfIds || !perfIds.length) {\n    return false\n  }\n  const message = `${text} ${perfIds.length} time${perfIds.length === 1 ? '' : 's'}`\n  return <Tooltip title={message} trigger=\"mouseenter focus click\">\n    <span className=\"song__perfcount\" aria-label=\"notes\" role=\"img\">×{perfIds.length}\n      <span className=\"hidden\">{message}</span>\n    </span>\n  </Tooltip>\n}\nfunction SongLink({data: {author, core_gd, cover_gd, id, suite, title, performances}, full}) {\n  return <Link to={`/song/${id}`}>\n    \"{title}\"\n    {full && <>\n      {' '}\n      {suite && <span className=\"song__suite\">{suite} suite</span>}\n      {' '}\n      {(!core_gd || cover_gd) && <Author name={author} />}\n    </>}\n  </Link>\n}\n\nfunction SortableTable({columns, data, link=true}) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow\n  } = useTable({columns, data}, useRowState, useSortBy)\n  return <table {...getTableProps()}>\n    <thead>\n      {headerGroups.map(headerGroup =>\n        <tr {...headerGroup.getHeaderGroupProps()}>\n          {headerGroup.headers.map(column =>\n            <th {...column.getHeaderProps(column.getSortByToggleProps())} style={{borderBottom: 'solid 3px gray', background: 'aliceblue', fontWeight: 'bold'}}>\n              {column.render('Header')}\n              <span className=\"songs__performed-table__column-sort\">\n                {column.isSorted ? column.isSortedDesc ? '⬇︎' : '⬆︎' : '⇅'}\n              </span>\n            </th>\n          )}\n        </tr>\n      )}\n    </thead>\n    <tbody {...getTableBodyProps()}>\n      {rows.map(row => {\n        prepareRow(row) // no return value; mutates `row`?\n        return <tr {...row.getRowProps()}>\n          {row.cells.map(cell =>\n            <td {...cell.getCellProps()}>\n              {cell.column?.id === 'title' && link\n                ? <SongLink data={cell.row.original} />\n                : cell.render('Cell')}\n            </td>\n          )}\n        </tr>\n      })}\n    </tbody>\n  </table>\n}\n\nfunction SongsComponent({data: {allSongsCsv: {nodes: songs}, allTeasesCsv: {nodes: teases}}}) {\n  const groupedByPerformed = groupBy((songData) => Boolean(songData.performances), songs.filter(removeCertainSongs))\n  const performedData = useMemo(\n    () => groupedByPerformed[true].map(songData => ({\n      ...songData,\n      performances: String(songData.performances).split(':').length,\n    })),\n    []\n  )\n  const performedColumns = useMemo(\n    () => [\n      { Header: \"title\", accessor: \"title\" },\n      { Header: \"author\", accessor: \"author\" },\n      { Header: \"suite\", accessor: \"suite\" },\n      { Header: \"plays\", accessor: \"performances\" },\n    ],\n    []\n  )\n\n  const allSongIdsFromTeases = teases.reduce((a,e) => a.concat(e.song_id), [])\n  const groupedByTeased = groupBy(songData => allSongIdsFromTeases.includes(songData.id), groupedByPerformed[false])\n  const teasedData = useMemo(\n    () => groupedByTeased[true].map(songData => ({\n      ...songData,\n      teases: filter(propEq('song_id', songData.id))(teases).map((row) => row.performance_id).length,\n    })),\n    []\n  )\n  const teasedColumns = useMemo(\n    () => [\n      { Header: \"title\", accessor: \"title\" },\n      { Header: \"author\", accessor: \"author\" },\n      { Header: \"teases\", accessor: \"teases\" },\n    ],\n    []\n  )\n\n  return <Layout className=\"songs\">\n    <SEO\n      title=\"JRAD songs played or teased\"\n      description=\"Repertoire of songs and teases performed by Joe Russo's Almost Dead, plus setlists of each concert\"\n    />\n\n    <div id=\"songs__toc\" className=\"tableofcontents\">\n      <p>Table of Contents</p>\n      <ol>\n        <li><a href=\"#songs__performed-headline\">Songs Performed / Jammed</a></li>\n        <li><a href=\"#songs__teased-headline\">Songs Teased</a></li>\n      </ol>\n    </div>\n\n    <h1 href=\"#songs__performed-headline\">Songs Performed / Jammed</h1>\n    <p>These songs have been performed in their entirety, or played as an extended theme by the entire band.</p>\n    <SortableTable columns={performedColumns} data={performedData} />\n\n    <h1 id=\"songs__teased-headline\">Songs Teased</h1>\n    <p>These are songs which have been hinted at by one or more members of the band while playing another song.</p>\n    <SortableTable columns={teasedColumns} data={teasedData} />\n\n    {'#notyet' === global?.window?.location?.hash /* TODO this can trigger a runtime error in browser */ && <>\n      <h1 id=\"songs__notyet-headline\">Not Yet Played from the GD Repertoire</h1>\n      <p>This is an incomplete list of songs which the Grateful Dead or their members recorded or played live (either together or in other projects), but have been neither played nor teased by JRAD...</p>\n      <SortableTable\n        columns={useMemo(() => [{Header: \"title\", accessor: \"title\"}, {Header: \"author\", accessor: \"author\"}], [])}\n        data={useMemo(() => groupedByTeased[false], [])}\n        link={false}\n      />\n    </>}\n  </Layout>\n}\n\nconst SongsPage = () => <StaticQuery\n  query={graphql`\n    query SongsPageData {\n      allSongsCsv { nodes {\n        author\n        core_gd\n        core_jrad\n        cover_gd\n        id\n        performances\n        suite\n        title\n      } }\n      allTeasesCsv { nodes {\n        id\n        by\n        notes\n        performance_id\n        song_id\n        song_name\n        within\n      } }\n    }\n  `}\n  render={data => <SongsComponent data={data} />}\n/>\nexport default SongsPage\n"],"sourceRoot":""}